{
  "version": 3,
  "sources": ["../../../worker/index.ts"],
  "sourceRoot": "D:\\\u6211\u7684\u684C\u9762\\mistmall-clean\\.wrangler\\tmp\\deploy-cWLIh3",
  "sourcesContent": ["export interface Env {\r\n    DB: D1Database\r\n    ADMIN_TOKEN: string\r\n  }\r\n  \r\n  function withCorsHeaders(init: ResponseInit = {}) {\r\n    return {\r\n      ...init,\r\n      headers: {\r\n        \"access-control-allow-origin\": \"*\",\r\n        \"access-control-allow-methods\": \"GET,POST,PATCH,DELETE,OPTIONS\",\r\n        \"access-control-allow-headers\": \"content-type,authorization\",\r\n        ...(init.headers || {})\r\n      }\r\n    } as ResponseInit\r\n  }\r\n  \r\n  function json(data: any, init: ResponseInit = {}) {\r\n    return new Response(JSON.stringify(data, null, 2), withCorsHeaders({\r\n      ...init,\r\n      headers: {\r\n        \"content-type\": \"application/json; charset=utf-8\",\r\n        ...(init.headers || {})\r\n      }\r\n    }))\r\n  }\r\n  \r\n  function html(body: string, init: ResponseInit = {}) {\r\n    return new Response(body, withCorsHeaders({\r\n      ...init,\r\n      headers: {\r\n        \"content-type\": \"text/html; charset=utf-8\",\r\n        ...(init.headers || {})\r\n      }\r\n    }))\r\n  }\r\n  \r\n  function readBearerToken(req: Request): string | null {\r\n    const h = req.headers.get(\"authorization\") || req.headers.get(\"Authorization\")\r\n    if (!h) return null\r\n    const m = h.match(/^Bearer\\s+(.+)$/i)\r\n    if (!m) return null\r\n    return m[1].trim()\r\n  }\r\n  \r\n  function requireAdmin(req: Request, env: Env): Response | null {\r\n    const t = readBearerToken(req)\r\n    if (!t || t !== env.ADMIN_TOKEN) {\r\n      return json({ ok: false, error: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n    return null\r\n  }\r\n  \r\n  function parseOrderNoFromPath(pathname: string, prefix: string) {\r\n    // pathname: /api/admin/orders/{orderNo}...\r\n    const raw = pathname.slice(prefix.length)\r\n    const cleaned = raw.replace(/^\\/+/, \"\").trim()\r\n    return cleaned ? decodeURIComponent(cleaned.split(\"/\")[0]) : \"\"\r\n  }\r\n  \r\n  async function safeJson(req: Request) {\r\n    try {\r\n      return await req.json()\r\n    } catch {\r\n      return null\r\n    }\r\n  }\r\n  \r\n  const ADMIN_HTML = `<!doctype html>\r\n  <html lang=\"zh-Hant\">\r\n  <head>\r\n    <meta charset=\"utf-8\" />\r\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\r\n    <title>MistMall /admin</title>\r\n    <style>\r\n      :root { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }\r\n      body { margin: 0; background: #f6f7fb; color: #111; }\r\n      header { position: sticky; top: 0; background: #fff; border-bottom: 1px solid #e8e8ee; }\r\n      .wrap { max-width: 1100px; margin: 0 auto; padding: 14px; }\r\n      .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }\r\n      .card { background: #fff; border: 1px solid #e8e8ee; border-radius: 12px; }\r\n      .pad { padding: 12px; }\r\n      input, button, select { font: inherit; }\r\n      input { padding: 10px 12px; border: 1px solid #d9d9e3; border-radius: 10px; width: 320px; }\r\n      button { padding: 10px 12px; border: 1px solid #d9d9e3; background: #fff; border-radius: 10px; cursor: pointer; }\r\n      button.primary { background: #111; color: #fff; border-color: #111; }\r\n      button.danger { background: #fff; color: #b00020; border-color: #f0c6cd; }\r\n      button.ok { background: #0f7b3a; color: #fff; border-color: #0f7b3a; }\r\n      .muted { color: #666; font-size: 13px; }\r\n      .grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 12px; margin-top: 12px; }\r\n      @media (max-width: 980px){ .grid { grid-template-columns: 1fr; } input { width: 100%; } }\r\n      table { width: 100%; border-collapse: collapse; }\r\n      th, td { text-align: left; padding: 10px; border-bottom: 1px solid #eee; vertical-align: top; }\r\n      th { font-size: 13px; color: #444; background: #fafafa; }\r\n      tr:hover td { background: #fcfcff; }\r\n      .pill { display: inline-flex; align-items: center; padding: 3px 8px; border-radius: 999px; font-size: 12px; border: 1px solid #e8e8ee; }\r\n      .pill.pending { background: #fff7db; border-color: #f5d58a; }\r\n      .pill.shipped { background: #e9f8ef; border-color: #bfe9cc; }\r\n      .pill.cancelled { background: #fdecec; border-color: #f3b8b8; }\r\n      .pill.deleted { background: #f3f4f6; border-color: #e5e7eb; }\r\n      .k { font-size: 12px; color: #666; }\r\n      .v { font-weight: 650; }\r\n      .mono { font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace; }\r\n      .toast { position: fixed; right: 14px; bottom: 14px; background: #111; color: #fff; padding: 10px 12px; border-radius: 10px; opacity: 0; transform: translateY(8px); transition: .18s; }\r\n      .toast.show { opacity: 1; transform: translateY(0); }\r\n      .small { font-size: 12px; }\r\n      .btnbar { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }\r\n      .box { border: 1px solid #eee; border-radius: 10px; padding: 10px; background: #fafafa; }\r\n      .hr { height: 1px; background: #eee; margin: 10px 0; }\r\n      .row2 { display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }\r\n      .select { padding: 10px 12px; border: 1px solid #d9d9e3; border-radius: 10px; background:#fff; }\r\n    </style>\r\n  </head>\r\n  <body>\r\n  <header>\r\n    <div class=\"wrap\">\r\n      <div class=\"row\" style=\"justify-content: space-between;\">\r\n        <div>\r\n          <div style=\"font-weight:800; font-size:16px;\">MistMall \u5F8C\u53F0</div>\r\n          <div class=\"muted\">\u7528\u700F\u89BD\u5668\u770B\u8A02\u55AE\uFF1A/admin\uFF08\u4E0D\u9700\u8981 Thunder / SQL\uFF09</div>\r\n        </div>\r\n        <div class=\"row\">\r\n          <input id=\"token\" class=\"mono\" placeholder=\"\u8CBC\u4E0A ADMIN_TOKEN\uFF08\u53EA\u5B58\u5728\u4F60\u700F\u89BD\u5668 localStorage\uFF09\" />\r\n          <button id=\"saveToken\" class=\"primary\">\u5132\u5B58 Token</button>\r\n          <button id=\"clearToken\" class=\"danger\">\u6E05\u9664</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </header>\r\n  \r\n  <main class=\"wrap\">\r\n    <div class=\"card pad\">\r\n      <div class=\"row2\">\r\n        <div class=\"row\">\r\n          <button id=\"refresh\" class=\"primary\">\u91CD\u65B0\u8F09\u5165</button>\r\n          <input id=\"q\" placeholder=\"\u641C\u5C0B\uFF1A\u8A02\u55AE\u865F / \u59D3\u540D / \u96FB\u8A71\" />\r\n          <span id=\"stat\" class=\"muted\"></span>\r\n        </div>\r\n        <div class=\"row\">\r\n          <span class=\"muted small\">\u986F\u793A\uFF1A</span>\r\n          <select id=\"viewMode\" class=\"select\">\r\n            <option value=\"active\" selected>\u53EA\u770B\u5F85\u8655\u7406\uFF08\u96B1\u85CF\u5DF2\u522A\u9664\uFF09</option>\r\n            <option value=\"all\">\u5168\u90E8\uFF08\u5305\u542B\u5DF2\u522A\u9664\uFF09</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div class=\"muted small\" style=\"margin-top:8px;\">\r\n        \u82E5\u770B\u5230 401\uFF1A\u8868\u793A Token \u672A\u5B58\u6216\u4E0D\u6B63\u78BA\u3002\u9019\u662F\u6B63\u5E38\u7684\u5B89\u5168\u6A5F\u5236\u3002\r\n      </div>\r\n    </div>\r\n  \r\n    <div class=\"grid\">\r\n      <section class=\"card\">\r\n        <div class=\"pad\" style=\"border-bottom:1px solid #eee;\">\r\n          <div style=\"font-weight:800;\">\u8A02\u55AE\u5217\u8868</div>\r\n          <div class=\"muted small\">\u5F85\u78BA\u8A8D\u6703\u512A\u5148\u6392\u5E8F</div>\r\n        </div>\r\n        <div class=\"pad\" style=\"padding-top:0;\">\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th style=\"width:160px;\">\u8A02\u55AE\u865F</th>\r\n                <th style=\"width:110px;\">\u72C0\u614B</th>\r\n                <th>\u6536\u4EF6\u4EBA</th>\r\n                <th style=\"width:170px;\">\u5EFA\u7ACB\u6642\u9593</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"list\"></tbody>\r\n          </table>\r\n        </div>\r\n      </section>\r\n  \r\n      <aside class=\"card\">\r\n        <div class=\"pad\" style=\"border-bottom:1px solid #eee;\">\r\n          <div style=\"font-weight:800;\">\u8A02\u55AE\u8A73\u60C5</div>\r\n          <div id=\"detailHint\" class=\"muted small\">\u9EDE\u5DE6\u908A\u4E00\u7B46\u8A02\u55AE\u67E5\u770B</div>\r\n        </div>\r\n        <div class=\"pad\" id=\"detail\"></div>\r\n      </aside>\r\n    </div>\r\n  </main>\r\n  \r\n  <div id=\"toast\" class=\"toast\"></div>\r\n  \r\n  <script>\r\n    const $ = (id) => document.getElementById(id);\r\n    const TOKEN_KEY = 'mistmall_admin_token';\r\n    let currentOrderNo = '';\r\n  \r\n    function toast(msg){\r\n      const t = $('toast');\r\n      t.textContent = msg;\r\n      t.classList.add('show');\r\n      setTimeout(() => t.classList.remove('show'), 1200);\r\n    }\r\n  \r\n    function getToken(){ return localStorage.getItem(TOKEN_KEY) || ''; }\r\n    function setToken(v){ localStorage.setItem(TOKEN_KEY, (v || '').trim()); }\r\n    function clearToken(){ localStorage.removeItem(TOKEN_KEY); }\r\n  \r\n    const STATUS_ZH = {\r\n      pending: '\u5F85\u78BA\u8A8D',\r\n      shipped: '\u5DF2\u5BC4\u4EF6',\r\n      cancelled: '\u5DF2\u53D6\u6D88',\r\n      deleted: '\u5DF2\u522A\u9664'\r\n    };\r\n  \r\n    function statusRank(s){\r\n      const x = (s || '').toLowerCase();\r\n      if (x === 'pending') return 0;\r\n      if (x === 'shipped') return 1;\r\n      if (x === 'cancelled') return 2;\r\n      if (x === 'deleted') return 9;\r\n      return 5;\r\n    }\r\n  \r\n    function statusLabel(status){\r\n      const s = (status || '').toLowerCase();\r\n      return STATUS_ZH[s] || (status || '-');\r\n    }\r\n  \r\n    function pill(status){\r\n      const s = (status || '').toLowerCase();\r\n      const cls = ['pill', s].join(' ');\r\n      return '<span class=\"' + cls + '\">' + statusLabel(status) + '</span>';\r\n    }\r\n  \r\n    function fmtTime(v){\r\n      if (!v) return '-';\r\n      const d = new Date(v);\r\n      if (!isNaN(d.getTime())) return d.toLocaleString();\r\n      return String(v);\r\n    }\r\n  \r\n    async function api(path, opt = {}){\r\n      const token = getToken();\r\n      const headers = opt.headers ? opt.headers : {};\r\n      if (token) headers['Authorization'] = 'Bearer ' + token;\r\n      if (opt.json) headers['Content-Type'] = 'application/json; charset=utf-8';\r\n  \r\n      const res = await fetch(path, {\r\n        method: opt.method || 'GET',\r\n        headers,\r\n        body: opt.json ? JSON.stringify(opt.json) : opt.body\r\n      });\r\n  \r\n      const text = await res.text();\r\n      let data = null;\r\n      try { data = text ? JSON.parse(text) : null; } catch { data = { raw: text }; }\r\n  \r\n      if (!res.ok){\r\n        const err = new Error('HTTP ' + res.status);\r\n        err.status = res.status;\r\n        err.body = data;\r\n        throw err;\r\n      }\r\n      return data;\r\n    }\r\n  \r\n    function escapeHtml(s){\r\n      return String(s ?? '').replace(/[&<>\"']/g, (c) => ({\r\n        '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'\r\n      }[c]));\r\n    }\r\n  \r\n    function renderList(rows){\r\n      const q = ($('q').value || '').trim().toLowerCase();\r\n      const mode = $('viewMode').value || 'active';\r\n  \r\n      let filtered = rows || [];\r\n  \r\n      // \u9810\u8A2D\u96B1\u85CF deleted\r\n      if (mode !== 'all'){\r\n        filtered = filtered.filter(o => String(o.status || '').toLowerCase() !== 'deleted');\r\n      }\r\n  \r\n      if (q){\r\n        filtered = filtered.filter(o =>\r\n          String(o.order_no || '').toLowerCase().includes(q) ||\r\n          String(o.name || '').toLowerCase().includes(q) ||\r\n          String(o.phone || '').toLowerCase().includes(q)\r\n        );\r\n      }\r\n  \r\n      filtered.sort((a,b) => {\r\n        const ra = statusRank(a.status), rb = statusRank(b.status);\r\n        if (ra !== rb) return ra - rb;\r\n        return String(b.created_at||'').localeCompare(String(a.created_at||''));\r\n      });\r\n  \r\n      const tbody = $('list');\r\n      tbody.innerHTML = filtered.map(o => {\r\n        const who = [o.name, o.phone].filter(Boolean).join(' / ') || '-';\r\n        return \\`\r\n          <tr data-order=\"\\${escapeHtml(o.order_no)}\" style=\"cursor:pointer;\">\r\n            <td class=\"mono\">\\${escapeHtml(o.order_no)}</td>\r\n            <td>\\${pill(o.status)}</td>\r\n            <td>\\${escapeHtml(who)}<div class=\"muted small\">\\${escapeHtml(o.store_name || '')}</div></td>\r\n            <td>\\${escapeHtml(fmtTime(o.created_at))}</td>\r\n          </tr>\r\n        \\`;\r\n      }).join('');\r\n  \r\n      $('stat').textContent = \\`\u986F\u793A \\${filtered.length} / \\${(rows||[]).length}\\`;\r\n  \r\n      Array.from(tbody.querySelectorAll('tr')).forEach(tr => {\r\n        tr.addEventListener('click', () => loadDetail(tr.getAttribute('data-order')));\r\n      });\r\n    }\r\n  \r\n    async function updateStatus(orderNo, nextStatus){\r\n      if (!orderNo) return;\r\n      await api('/api/admin/orders/' + encodeURIComponent(orderNo) + '/status', {\r\n        method: 'PATCH',\r\n        json: { status: nextStatus }\r\n      });\r\n    }\r\n  \r\n    async function deleteOrder(orderNo){\r\n      if (!orderNo) return;\r\n      await api('/api/admin/orders/' + encodeURIComponent(orderNo), {\r\n        method: 'DELETE'\r\n      });\r\n    }\r\n  \r\n    function renderDetail(order){\r\n      const d = $('detail');\r\n      $('detailHint').textContent = '';\r\n      currentOrderNo = order.order?.order_no || '';\r\n  \r\n      const info = {\r\n        orderNo: order.order?.order_no || '',\r\n        status: order.order?.status || '',\r\n        createdAt: order.order?.created_at || '',\r\n        name: order.order?.name || '',\r\n        phone: order.order?.phone || '',\r\n        storeNo: order.order?.store_no || '',\r\n        storeName: order.order?.store_name || '',\r\n        storeAddress: order.order?.store_address || '',\r\n        amount: order.order?.amount ?? ''\r\n      };\r\n  \r\n      const items = order.items || [];\r\n      const itemsHtml = items.length ? items.map(it => \\`\r\n        <div class=\"box\" style=\"margin-top:8px;\">\r\n          <div class=\"v\">\\${escapeHtml(it.product_name || '-')}</div>\r\n          <div class=\"muted small\">\\${escapeHtml(it.variant_text || '')}</div>\r\n          <div class=\"muted small\">qty: \\${escapeHtml(it.qty)} / unit: \\${escapeHtml(it.unit_price)} / total: \\${escapeHtml(it.line_total)}</div>\r\n        </div>\r\n      \\`).join('') : '<div class=\"muted small\">\uFF08\u7121\u5546\u54C1\u660E\u7D30\uFF09</div>';\r\n  \r\n      const shipText =\r\n  \\`\u8A02\u55AE\u865F\uFF1A\\${info.orderNo}\r\n  \u72C0\u614B\uFF1A\\${statusLabel(info.status)}\r\n  \u5EFA\u7ACB\uFF1A\\${fmtTime(info.createdAt)}\r\n  \r\n  \u6536\u4EF6\u4EBA\uFF1A\\${info.name}\r\n  \u96FB\u8A71\uFF1A\\${info.phone}\r\n  \r\n  7-11\u9580\u5E02\uFF1A\\${info.storeName}\uFF08\\${info.storeNo}\uFF09\r\n  \u9580\u5E02\u5730\u5740\uFF1A\\${info.storeAddress}\r\n  \r\n  \u91D1\u984D\uFF1A\\${info.amount}\\`;\r\n  \r\n      d.innerHTML = \\`\r\n        <div class=\"box\">\r\n          <div class=\"k\">\u8A02\u55AE\u865F</div><div class=\"v mono\">\\${escapeHtml(info.orderNo)}</div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u72C0\u614B</div><div class=\"v\">\\${pill(info.status)}</div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u5EFA\u7ACB\u6642\u9593</div><div class=\"v\">\\${escapeHtml(fmtTime(info.createdAt))}</div>\r\n  \r\n          <div class=\"hr\"></div>\r\n  \r\n          <div class=\"row\" style=\"justify-content: space-between;\">\r\n            <div class=\"muted small\">\u51FA\u8CA8\u64CD\u4F5C</div>\r\n            <div class=\"row\">\r\n              <button id=\"markShipped\" class=\"ok\">\u6A19\u8A18\u5DF2\u5BC4\u4EF6</button>\r\n              <button id=\"markPending\">\u6539\u56DE\u5F85\u78BA\u8A8D</button>\r\n              <button id=\"delOrder\" class=\"danger\">\u522A\u9664\u6B64\u8A02\u55AE</button>\r\n            </div>\r\n          </div>\r\n          <div class=\"muted small\" style=\"margin-top:6px;\">\r\n            \u522A\u9664\u63A1\u7528\u300C\u5B89\u5168\u522A\u9664\u300D\uFF1A\u72C0\u614B\u6703\u8B8A\u6210\u5DF2\u522A\u9664\uFF0C\u9810\u8A2D\u4E0D\u986F\u793A\u3002\r\n          </div>\r\n        </div>\r\n  \r\n        <div class=\"box\" style=\"margin-top:10px;\">\r\n          <div class=\"k\">\u6536\u4EF6\u4EBA</div><div class=\"v\">\\${escapeHtml(info.name)}</div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u96FB\u8A71</div><div class=\"v mono\">\\${escapeHtml(info.phone)}</div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u9580\u5E02</div><div class=\"v\">\\${escapeHtml(info.storeName)} <span class=\"muted small\">(\\${escapeHtml(info.storeNo)})</span></div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u9580\u5E02\u5730\u5740</div><div class=\"v\">\\${escapeHtml(info.storeAddress)}</div>\r\n          <div class=\"k\" style=\"margin-top:6px;\">\u91D1\u984D</div><div class=\"v\">\\${escapeHtml(info.amount)}</div>\r\n  \r\n          <div class=\"btnbar\">\r\n            <button id=\"copyShip\" class=\"primary\">\u4E00\u9375\u8907\u88FD\u5BC4\u4EF6\u8CC7\u8A0A</button>\r\n            <button id=\"copyOrderNo\">\u8907\u88FD\u8A02\u55AE\u865F</button>\r\n          </div>\r\n        </div>\r\n  \r\n        <div style=\"margin-top:10px;\">\r\n          <div style=\"font-weight:800; margin-bottom:6px;\">\u5546\u54C1\u660E\u7D30</div>\r\n          \\${itemsHtml}\r\n        </div>\r\n      \\`;\r\n  \r\n      $('copyShip').addEventListener('click', async () => {\r\n        try {\r\n          await navigator.clipboard.writeText(shipText);\r\n          toast('\u5DF2\u8907\u88FD\u5BC4\u4EF6\u8CC7\u8A0A');\r\n        } catch {\r\n          const ta = document.createElement('textarea');\r\n          ta.value = shipText;\r\n          document.body.appendChild(ta);\r\n          ta.select();\r\n          document.execCommand('copy');\r\n          ta.remove();\r\n          toast('\u5DF2\u8907\u88FD\u5BC4\u4EF6\u8CC7\u8A0A');\r\n        }\r\n      });\r\n  \r\n      $('copyOrderNo').addEventListener('click', async () => {\r\n        try {\r\n          await navigator.clipboard.writeText(info.orderNo);\r\n          toast('\u5DF2\u8907\u88FD\u8A02\u55AE\u865F');\r\n        } catch {\r\n          toast('\u8907\u88FD\u5931\u6557\uFF08\u700F\u89BD\u5668\u9650\u5236\uFF09');\r\n        }\r\n      });\r\n  \r\n      $('markShipped').addEventListener('click', async () => {\r\n        try{\r\n          await updateStatus(info.orderNo, 'shipped');\r\n          toast('\u5DF2\u6A19\u8A18\uFF1A\u5DF2\u5BC4\u4EF6');\r\n          await loadList();\r\n          await loadDetail(info.orderNo);\r\n        }catch(e){\r\n          toast('\u64CD\u4F5C\u5931\u6557');\r\n        }\r\n      });\r\n  \r\n      $('markPending').addEventListener('click', async () => {\r\n        try{\r\n          await updateStatus(info.orderNo, 'pending');\r\n          toast('\u5DF2\u6539\u56DE\uFF1A\u5F85\u78BA\u8A8D');\r\n          await loadList();\r\n          await loadDetail(info.orderNo);\r\n        }catch(e){\r\n          toast('\u64CD\u4F5C\u5931\u6557');\r\n        }\r\n      });\r\n  \r\n      $('delOrder').addEventListener('click', async () => {\r\n        const ok = confirm('\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u8A02\u55AE\u55CE\uFF1F\\\\n\\\\n\u522A\u9664\u5F8C\u9810\u8A2D\u4E0D\u986F\u793A\uFF0C\u4F46\u4F60\u4ECD\u53EF\u5207\u5230\u300C\u5168\u90E8\uFF08\u5305\u542B\u5DF2\u522A\u9664\uFF09\u300D\u67E5\u770B\u3002');\r\n        if (!ok) return;\r\n        try{\r\n          await deleteOrder(info.orderNo);\r\n          toast('\u5DF2\u522A\u9664\uFF08\u5DF2\u96B1\u85CF\uFF09');\r\n          currentOrderNo = '';\r\n          $('detail').innerHTML = '<div class=\"muted small\">\u5DF2\u522A\u9664\u3002\u53EF\u91CD\u65B0\u8F09\u5165\u67E5\u770B\u5217\u8868\u3002</div>';\r\n          await loadList();\r\n        }catch(e){\r\n          toast('\u522A\u9664\u5931\u6557');\r\n        }\r\n      });\r\n    }\r\n  \r\n    async function loadList(){\r\n      $('stat').textContent = '\u8F09\u5165\u4E2D...';\r\n      try {\r\n        const res = await api('/api/admin/orders');\r\n        renderList(res.orders || []);\r\n      } catch (e){\r\n        $('list').innerHTML = '';\r\n        $('stat').textContent = '';\r\n        $('detail').innerHTML = '<div class=\"muted small\">\u7121\u6CD5\u8F09\u5165\uFF08\u53EF\u80FD\u672A\u8A2D\u5B9A Token \u6216 Token \u932F\u8AA4\uFF09</div>';\r\n        if (e && e.status) toast('\u932F\u8AA4\uFF1AHTTP ' + e.status);\r\n        else toast('\u8F09\u5165\u5931\u6557');\r\n      }\r\n    }\r\n  \r\n    async function loadDetail(orderNo){\r\n      if (!orderNo) return;\r\n      try {\r\n        const res = await api('/api/admin/orders/' + encodeURIComponent(orderNo));\r\n        renderDetail(res);\r\n      } catch (e){\r\n        $('detail').innerHTML = '<div class=\"muted small\">\u7121\u6CD5\u8F09\u5165\u8A73\u60C5</div>';\r\n        if (e && e.status) toast('\u932F\u8AA4\uFF1AHTTP ' + e.status);\r\n        else toast('\u8F09\u5165\u5931\u6557');\r\n      }\r\n    }\r\n  \r\n    $('saveToken').addEventListener('click', () => {\r\n      setToken($('token').value);\r\n      toast('\u5DF2\u5132\u5B58 Token');\r\n      loadList();\r\n    });\r\n    $('clearToken').addEventListener('click', () => {\r\n      clearToken();\r\n      $('token').value = '';\r\n      toast('\u5DF2\u6E05\u9664 Token');\r\n    });\r\n    $('refresh').addEventListener('click', loadList);\r\n    $('q').addEventListener('input', () => loadList());\r\n    $('viewMode').addEventListener('change', () => loadList());\r\n  \r\n    // init\r\n    $('token').value = getToken();\r\n    loadList();\r\n  </script>\r\n  </body>\r\n  </html>`\r\n  \r\n  export default {\r\n    async fetch(req: Request, env: Env): Promise<Response> {\r\n      const url = new URL(req.url)\r\n  \r\n      // Preflight\r\n      if (req.method === \"OPTIONS\") return json({ ok: true })\r\n  \r\n      // \u4EBA\u6027\u5316\u5F8C\u53F0\u9801\u9762\r\n      if (url.pathname === \"/admin\" || url.pathname === \"/admin/\") {\r\n        return html(ADMIN_HTML)\r\n      }\r\n  \r\n      // \u5065\u5EB7\u6AA2\u67E5\r\n      if (url.pathname === \"/api/health\") {\r\n        return json({ ok: true })\r\n      }\r\n  \r\n      // \u5BA2\u6236\u4E0B\u55AE\r\n      if (url.pathname === \"/api/orders\" && req.method === \"POST\") {\r\n        const body = await safeJson(req) || {}\r\n        const orderNo = \"ORD\" + Date.now()\r\n        const createdAt = new Date().toISOString()\r\n  \r\n        await env.DB.prepare(\r\n          `INSERT INTO orders\r\n           (order_no, created_at, status, name, phone, store_no, store_name, store_address, amount)\r\n           VALUES (?, ?, 'pending', ?, ?, ?, ?, ?, ?)`\r\n        ).bind(\r\n          orderNo,\r\n          createdAt,\r\n          body.name,\r\n          body.phone,\r\n          body.storeNo,\r\n          body.storeName,\r\n          body.storeAddress,\r\n          body.amount\r\n        ).run()\r\n  \r\n        for (const it of (body.items || [])) {\r\n          await env.DB.prepare(\r\n            `INSERT INTO order_items\r\n             (order_no, product_name, variant_text, qty, unit_price, line_total)\r\n             VALUES (?, ?, ?, ?, ?, ?)`\r\n          ).bind(\r\n            orderNo,\r\n            it.productName,\r\n            Array.isArray(it.specs) ? it.specs.join(\" / \") : String(it.specs ?? \"\"),\r\n            it.qty,\r\n            it.unitPrice,\r\n            it.subtotal\r\n          ).run()\r\n        }\r\n  \r\n        return json({ ok: true, orderNo })\r\n      }\r\n  \r\n      // \u2705 \u5F8C\u53F0\uFF1A\u5217\u51FA\u6240\u6709\u8A02\u55AE\uFF08Authorization: Bearer\uFF09\r\n      if (url.pathname === \"/api/admin/orders\" && req.method === \"GET\") {\r\n        const deny = requireAdmin(req, env)\r\n        if (deny) return deny\r\n  \r\n        const orders = await env.DB.prepare(\r\n          `SELECT\r\n            order_no,\r\n            created_at,\r\n            status,\r\n            name,\r\n            phone,\r\n            store_no,\r\n            store_name,\r\n            store_address,\r\n            amount\r\n          FROM orders\r\n          ORDER BY created_at DESC`\r\n        ).all()\r\n  \r\n        return json({ ok: true, orders: orders.results })\r\n      }\r\n  \r\n      // \u2705 \u5F8C\u53F0\uFF1A\u67E5\u8A62\u55AE\u7B46\u8A02\u55AE\uFF08\u542B items\uFF09\r\n      if (req.method === \"GET\" && url.pathname.startsWith(\"/api/admin/orders/\") && !url.pathname.endsWith(\"/status\")) {\r\n        const deny = requireAdmin(req, env)\r\n        if (deny) return deny\r\n  \r\n        const orderNo = parseOrderNoFromPath(url.pathname, \"/api/admin/orders/\")\r\n        if (!orderNo) return json({ ok: false, error: \"Bad Request\" }, { status: 400 })\r\n  \r\n        const order = await env.DB.prepare(\r\n          `SELECT\r\n            order_no,\r\n            created_at,\r\n            status,\r\n            name,\r\n            phone,\r\n            store_no,\r\n            store_name,\r\n            store_address,\r\n            amount\r\n          FROM orders\r\n          WHERE order_no = ?\r\n          LIMIT 1`\r\n        ).bind(orderNo).first()\r\n  \r\n        if (!order) return json({ ok: false, error: \"Not Found\" }, { status: 404 })\r\n  \r\n        const items = await env.DB.prepare(\r\n          `SELECT\r\n            order_no,\r\n            product_name,\r\n            variant_text,\r\n            qty,\r\n            unit_price,\r\n            line_total\r\n          FROM order_items\r\n          WHERE order_no = ?\r\n          ORDER BY rowid ASC`\r\n        ).bind(orderNo).all()\r\n  \r\n        return json({ ok: true, order, items: items.results })\r\n      }\r\n  \r\n      // \u2705 \u5F8C\u53F0\uFF1A\u66F4\u65B0\u72C0\u614B\uFF08pending / shipped / cancelled / deleted\uFF09\r\n      // PATCH /api/admin/orders/{orderNo}/status  body: { status: \"shipped\" }\r\n      if (req.method === \"PATCH\" && url.pathname.startsWith(\"/api/admin/orders/\") && url.pathname.endsWith(\"/status\")) {\r\n        const deny = requireAdmin(req, env)\r\n        if (deny) return deny\r\n  \r\n        const orderNo = parseOrderNoFromPath(url.pathname, \"/api/admin/orders/\")\r\n        if (!orderNo) return json({ ok: false, error: \"Bad Request\" }, { status: 400 })\r\n  \r\n        const body = await safeJson(req) || {}\r\n        const next = String(body.status || \"\").toLowerCase().trim()\r\n        const allow = new Set([\"pending\", \"shipped\", \"cancelled\", \"deleted\"])\r\n        if (!allow.has(next)) {\r\n          return json({ ok: false, error: \"Invalid status\" }, { status: 400 })\r\n        }\r\n  \r\n        const r = await env.DB.prepare(\r\n          `UPDATE orders SET status = ? WHERE order_no = ?`\r\n        ).bind(next, orderNo).run()\r\n  \r\n        return json({ ok: true, updated: r.meta?.changes ?? 0, status: next })\r\n      }\r\n  \r\n      // \u2705 \u5F8C\u53F0\uFF1A\u522A\u9664\uFF08\u5B89\u5168\u522A\u9664\uFF1D\u6539\u6210 deleted\uFF09\r\n      // DELETE /api/admin/orders/{orderNo}\r\n      if (req.method === \"DELETE\" && url.pathname.startsWith(\"/api/admin/orders/\")) {\r\n        const deny = requireAdmin(req, env)\r\n        if (deny) return deny\r\n  \r\n        const orderNo = parseOrderNoFromPath(url.pathname, \"/api/admin/orders/\")\r\n        if (!orderNo) return json({ ok: false, error: \"Bad Request\" }, { status: 400 })\r\n  \r\n        const r = await env.DB.prepare(\r\n          `UPDATE orders SET status = 'deleted' WHERE order_no = ?`\r\n        ).bind(orderNo).run()\r\n  \r\n        return json({ ok: true, deleted: r.meta?.changes ?? 0 })\r\n      }\r\n  \r\n      // \uD83D\uDD01 \u76F8\u5BB9\u4FDD\u7559\uFF1A\u4F60\u820A\u7684 /admin/orders?token=...\uFF08\u5EFA\u8B70\u9010\u6B65\u6DD8\u6C70\uFF09\r\n      if (url.pathname === \"/admin/orders\" && req.method === \"GET\") {\r\n        const token = url.searchParams.get(\"token\")\r\n        if (token !== env.ADMIN_TOKEN) {\r\n          return json({ ok: false, error: \"Unauthorized\" }, { status: 401 })\r\n        }\r\n  \r\n        const orders = await env.DB.prepare(\r\n          `SELECT\r\n            order_no,\r\n            created_at,\r\n            status,\r\n            name,\r\n            phone,\r\n            store_no,\r\n            store_name,\r\n            store_address,\r\n            amount\r\n          FROM orders\r\n          ORDER BY created_at DESC`\r\n        ).all()\r\n  \r\n        return json({ ok: true, orders: orders.results })\r\n      }\r\n  \r\n      return json({ ok: false, error: \"Not Found\" }, { status: 404 })\r\n    }\r\n  }\r\n  "],
  "mappings": "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",
  "names": []
}
